<!DOCTYPE html>
<html lang='en'>
  <head>
    <title data-i18n="raid-title">MigraMap 2.0 | Report a Raid</title>
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta content='' name='description' />
    <meta content='' name='author' />
    <!-- Styles -->
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
    <link rel="stylesheet" href="css/custom.css"/>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script type="text/javascript" src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class='navbar navbar-default navbar-static-top'>
      <div class='container-fluid'>
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class='navbar-brand' href='index.html'><img class="img" src="images/MigraMap.png" alt="MigraMap 2.0" title="MigraMap 2.0"></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html" title="Map" data-i18n="[title]nav.map;nav.map">Map</a></li>
            <li><a href="about.html" title="About MigraMap" data-i18n="[title]nav.about;nav.about">About MigraMap</a></li>
            <li class="active"><a href="raid.html" title="Report a Raid" data-i18n="[title]nav.raid;nav.raid">Report a Raid</a></li>
          </ul>
          <div class="nav navbar-nav">
              <a href='http://www.latinorebels.com/' target="_blank" title="Latino Rebels home">
                  <img class="img latinorebels" src="images/Latino-Rebels.png" alt="Latino Rebels home">
              </a>
          </div>
          <ul class="nav navbar-nav navbar-right">
            <li class='dropdown'>
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" title="Choose a Language" data-i18n="[title]lang.title;lang.text">English &#9660;</a>
                <ul class="dropdown-menu">
                    <li>
                      <a href="#" title="English" data-i18n="en">English</a>
                    </li>
                    <li>
                      <a href="#" title="Espa&ntilde;ol" data-i18n="es">Espa&ntilde;ol</a>
                    </li>
                    <!--TBD: other languages? (will need translators/verifiers)-->
                </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class='container-fluid center-block'>
      <div class='row'>
          <div class='col-md-6 col-md-offset-3'>
           <h1>Report a Raid</h1>
              <form id="raid-form" class="form-horizontal" action="process-form.php" method="post">
                  <fieldset>
                      <div class="form-group">
                          <label class="col-md-4 control-label" for="form-search-address">Location</label>
                          <div class="col-md-4">
                              <input id="form-search-address" name="form-search-address" type="text" placeholder="Enter an address or an intersection" class="form-control input-md" required>
                          </div>
                      </div>
                      <div class="form-group">
                          <label class="col-md-4 control-label" for="datepicker">Date</label>
                          <div class="col-md-4">
                              <input type="text" id="datepicker" name="datepicker" value="1/01/2017" class="form-control input-md" required/>
                          </div>
                      </div>
                      <div class="form-group">
                          <label class="col-md-4 control-label">Successful Detainment</label>
                          <div class="col-md-4">
                              <div class="radio">
                                  <label for="radios1">
                                      <input type="radio" name="radios1" id="radios1" value="1">
                                      Yes
                                  </label>
                              </div>
                              <div class="radio">
                                  <label for="radios2">
                                      <input type="radio" name="radios2" id="radios2" value="0">
                                      No
                                  </label>
                              </div>
                              <div class="radio">
                                  <label for="radios3">
                                      <input type="radio" name="radios3" id="radios3" value="-1" checked>
                                      Unknown
                                  </label>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label class="col-md-4 control-label" for="numberDetainees">Number of Detainees</label>
                          <div class="col-md-4">
                              <select id="numberDetainees" name="numberDetainees" class="form-control">
                                  <option value="0">0</option>
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5">5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">+10</option>
                              </select>
                          </div>
                      </div>
                      <div class="form-group">
                          <label class="col-md-4 control-label" for="description">Description</label>
                          <div class="col-md-4">
                              <textarea class="form-control" id="description" name="description"></textarea>
                          </div>
                      </div>
                      <div class="form-group">
                          <label class="col-md-4 control-label" for="submit"></label>
                          <div class="col-md-4">
                              <button id="submit" name="submit" type="submit" class="btn btn-primary">Submit</button>
                          </div>
                      </div>
                  </fieldset>
              </form>
          </div>
      </div><!-- /.row-->
    </div> <!-- /.container-->

    <!-- jQuery from CDN -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- jQuery local fallback -->
    <script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="js/jquery-1.12.4.min.js"><\/script>')</script>
    <!-- bootstrap.js from CDN -->
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Bootstrap JS local fallback -->
    <script type="text/javascript">if(typeof($.fn.modal) === 'undefined') {document.write('<script type="text/javascript" src="js/bootstrap.min.js"><\/script>')}</script>
    <!-- Bootstrap CSS local fallback -->
    <div id="bootstrapCssTest" class="hidden"></div>
    <script type="text/javascript">
      $(function() {
        if ($('#bootstrapCssTest').is(':visible')) {
          $("head").prepend('<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css">');
        }
      });
    </script>

    <!-- i18next libraries -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/i18next/8.1.0/i18next.min.js" ></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-i18next/1.2.0/jquery-i18next.min.js" ></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/i18next-browser-languagedetector/1.0.1/i18nextBrowserLanguageDetector.min.js" ></script>
    <script type="text/javascript" src="js/i18nextXHRBackend.min.js" ></script>
    <script type="text/javascript" src="js/i18napp.js"></script>

    <script type="text/javascript" src="https://maps.google.com/maps/api/js?libraries=places&key=AIzaSyAVlYrvh7xDuvv6vbY7me9UHgwArCzZ4XI"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
    <script type="text/javascript">
            var options = {
                componentRestrictions: {
                    country: 'us'
                }
            };
            var autocomplete = new google.maps.places.Autocomplete(document.getElementById('form-search-address'), options);

            $('input[name="datepicker"]').daterangepicker({
                singleDatePicker: true,
                showDropdowns: true,
                timePicker: true,
                timePickerIncrement: 15,
                locale: {
                    format: 'MM/DD/YYYY h:mm A'
                }
            })

            $('#raid-form').submit(function(e) {
                e.preventDefault();
                // TODO : check for validation and check to see if people used the autocomplete
                var place = autocomplete.getPlace();
                var location = '';
                var zipCpde = '';
                if (place) {
                    location = place.geometry.location.lat() + ' ' + place.geometry.location.lng();
                    for (var i = 0; i < place.address_components.length; i++) {
                        var addressType = place.address_components[i].types[0];
                        if (addressType === 'postal_code') {
                            zipCode = place.address_components[i]["short_name"];
                        }
                    }
                } else {
                   location = $('#form-search-address').val();
                }

                var dateTime =  $('input[name="datepicker"]').data().daterangepicker.startDate._d;
                var time = moment(dateTime).format("hh:mm a");
                var date = moment(dateTime).format("MM/DD/YYYY");

                var successfulDetainment = '';
                if (radios1.checked) {
                    successfulDetainment = 'Yes'
                }
                if (radios2.checked) {
                    successfulDetainment = 'No'
                }
                if (radios1.checked) {
                    successfulDetainment = 'Unknown'
                }
                var numberDetainees = $('#numberDetainees').val();
                var description = $('#description').val();

                var dataString = 'location='+ location +'&date=' + date + '&time='+ time + '&successfulDetainment' + successfulDetainment
                    + '&numberDetainees' + numberDetainees + '&description' + description + '&successfulDetainment' + successfulDetainment;

                $.ajax({
                    type: 'POST',
                    url: process-form.php,
                    data: dataString,
                    success: function(result){
                    // TODO
                        alert(result);
                    },
                    error: function() {
                        alert('error!');
                    }
                });
            });
    </script>
  </body>
</html>
